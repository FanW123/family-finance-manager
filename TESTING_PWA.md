# PWA 测试指南

## 🚀 快速开始测试

### 1. 启动开发服务器

```bash
# 在项目根目录
npm run dev
```

服务器会在 `http://localhost:3000` 启动

### 2. 在浏览器中测试

#### Chrome/Edge (推荐)

1. **打开应用**
   - 访问 `http://localhost:3000`
   - 等待页面加载完成

2. **检查 Service Worker**
   - 按 `F12` 打开开发者工具
   - 切换到 **Application** 标签
   - 左侧菜单找到 **Service Workers**
   - 应该看到 `sw.js` 已注册，状态为 "activated and is running"

3. **检查 Manifest**
   - 在 **Application** 标签下找到 **Manifest**
   - 应该看到 FirePath 的配置信息
   - 检查图标、名称等是否正确

4. **测试安装提示**
   - 等待 3 秒，应该会在页面底部看到安装提示
   - 点击"安装"按钮
   - 或者点击地址栏右侧的安装图标（如果显示）

5. **测试离线功能**
   - 在 **Application** → **Service Workers** 中
   - 勾选 **Offline** 选项
   - 刷新页面，应该仍能正常显示（从缓存加载）

#### Safari (iOS 测试)

1. **在 iPhone 上访问**
   - 确保手机和电脑在同一 Wi-Fi
   - 在 Safari 中打开 `http://[你的电脑IP]:3000`
   - 例如：`http://192.168.1.100:3000`

2. **添加到主屏幕**
   - 点击底部的分享按钮（方框+箭头）
   - 选择"添加到主屏幕"
   - 可以自定义名称
   - 点击"添加"

3. **测试独立模式**
   - 从主屏幕打开应用
   - 应该以独立窗口模式运行（没有浏览器地址栏）

### 3. 检查清单

#### ✅ Service Worker 检查
- [ ] Service Worker 已注册
- [ ] 状态显示为 "activated"
- [ ] 离线模式下仍能访问

#### ✅ Manifest 检查
- [ ] Manifest 文件可访问
- [ ] 应用名称正确
- [ ] 主题色正确
- [ ] 图标配置正确（如果有）

#### ✅ 安装功能检查
- [ ] 显示安装提示（Chrome/Edge）
- [ ] 可以成功安装
- [ ] 安装后以独立窗口运行
- [ ] iOS Safari 可以添加到主屏幕

#### ✅ 离线功能检查
- [ ] 离线模式下页面仍能显示
- [ ] 静态资源从缓存加载
- [ ] API 请求在网络恢复后正常工作

## 🔍 常见问题排查

### Service Worker 未注册

**可能原因：**
- 文件路径错误
- 服务器未正确提供 `sw.js` 文件
- HTTPS 要求（生产环境）

**解决方法：**
1. 检查浏览器控制台是否有错误
2. 访问 `http://localhost:3000/sw.js` 看文件是否存在
3. 检查 `main.tsx` 中的注册代码

### 安装提示不显示

**可能原因：**
- 浏览器不支持 PWA
- 已经安装过
- 不满足安装条件

**解决方法：**
1. 使用 Chrome/Edge 浏览器
2. 清除浏览器数据后重试
3. 检查是否满足 PWA 安装条件（HTTPS、有效的 manifest 等）

### 离线功能不工作

**可能原因：**
- Service Worker 未正确缓存资源
- 缓存策略配置错误

**解决方法：**
1. 检查 Service Worker 代码
2. 在 Application → Cache Storage 中查看缓存内容
3. 清除缓存后重新测试

## 📱 手机测试步骤

### Android Chrome

1. 在手机上打开 Chrome
2. 访问应用地址
3. 应该会看到安装横幅
4. 或者点击菜单 → "添加到主屏幕"

### iOS Safari

1. 在 Safari 中打开应用
2. 点击分享按钮
3. 选择"添加到主屏幕"
4. 从主屏幕打开测试

## 🎯 测试重点

1. **基本功能**：确保所有功能在 PWA 模式下正常工作
2. **离线访问**：测试网络断开时的表现
3. **更新机制**：修改代码后，检查是否提示更新
4. **性能**：检查加载速度和响应时间

## 📝 测试记录模板

```
测试日期：_______
浏览器：_______
设备：_______

Service Worker: [ ] 通过 [ ] 失败
Manifest: [ ] 通过 [ ] 失败
安装功能: [ ] 通过 [ ] 失败
离线功能: [ ] 通过 [ ] 失败

问题记录：
1. 
2. 
```

